-- BoladoHub v1.2 - DRAG FUNCIONAL GARANTIDO
local MarketplaceService = game:GetService("MarketplaceService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local PlayerMouse = Player:GetMouse()

local boladolib = {
	Themes = {
		Darker = {
			["Color Hub 1"] = ColorSequence.new({
				ColorSequenceKeypoint.new(0.00, Color3.fromRGB(25, 25, 25)),
				ColorSequenceKeypoint.new(0.50, Color3.fromRGB(32.5, 32.5, 32.5)),
				ColorSequenceKeypoint.new(1.00, Color3.fromRGB(25, 25, 25))
			}),
			["Color Hub 2"] = Color3.fromRGB(30, 30, 30),
			["Color Stroke"] = Color3.fromRGB(40, 40, 40),
			["Color Theme"] = Color3.fromRGB(88, 101, 242),
			["Color Text"] = Color3.fromRGB(243, 243, 243),
			["Color Dark Text"] = Color3.fromRGB(180, 180, 180)
		}
	},
	Info = {
		Version = "1.2.0"
	},
	Save = {
		UISize = {550, 380},
		TabSize = 160,
		Theme = "Darker"
	},
	Settings = {},
	Connection = {},
	Instances = {},
	Elements = {},
	Options = {},
	Flags = {},
	Tabs = {},
	Icons = {
		["sword"] = "rbxassetid://10734975486",
		["eye"] = "rbxassetid://10723346959",
		["user"] = "rbxassetid://10747373176",
		["settings"] = "rbxassetid://10734950309",
		["star"] = "rbxassetid://10734966248",
		["bolt"] = "rbxassetid://10709721749"
	}
}

-- SISTEMA DE DRAG FUNCIONAL 100%
local function CreateDraggableWindow(frame, dragHandle)
	local dragging = false
	local dragStart = Vector2.new(0, 0)
	local frameStart = UDim2.new(0, 0, 0, 0)
	
	-- Conectar para MOUSE
	dragHandle.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = true
			dragStart = Vector2.new(PlayerMouse.X, PlayerMouse.Y)
			frameStart = frame.Position
			
			print("üñ±Ô∏è DRAG INICIADO - Mouse pressionado")
			
			-- Efeito visual
			TweenService:Create(dragHandle, TweenInfo.new(0.1), {
				BackgroundTransparency = 0.4
			}):Play()
		end
	end)
	
	-- Conectar para TOUCH (mobile)
	dragHandle.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.Touch then
			dragging = true
			dragStart = input.Position
			frameStart = frame.Position
			
			print("üëÜ DRAG INICIADO - Touch iniciado")
		end
	end)
	
	-- Sistema de atualiza√ß√£o usando RenderStepped (GARANTIDO)
	local dragConnection
	dragConnection = RunService.RenderStepped:Connect(function()
		if dragging then
			-- Para MOUSE
			if UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton1) then
				local currentMouse = Vector2.new(PlayerMouse.X, PlayerMouse.Y)
				local delta = currentMouse - dragStart
				
				frame.Position = UDim2.new(
					frameStart.X.Scale,
					frameStart.X.Offset + delta.X,
					frameStart.Y.Scale,
					frameStart.Y.Offset + delta.Y
				)
			end
			
			-- Para TOUCH
			local touchPoints = UserInputService:GetConnectedTouchPoints()
			if #touchPoints > 0 and dragging then
				local touch = touchPoints[1]
				local delta = touch.Position - dragStart
				
				frame.Position = UDim2.new(
					frameStart.X.Scale,
					frameStart.X.Offset + delta.X,
					frameStart.Y.Scale,
					frameStart.Y.Offset + delta.Y
				)
			end
		end
	end)
	
	-- Parar drag quando soltar
	UserInputService.InputEnded:Connect(function(input)
		if (input.UserInputType == Enum.UserInputType.MouseButton1) or
		   (input.UserInputType == Enum.UserInputType.Touch) then
			if dragging then
				dragging = false
				print("‚úã DRAG PARADO - Soltou")
				
				-- Restaurar visual
				TweenService:Create(dragHandle, TweenInfo.new(0.1), {
					BackgroundTransparency = 0
				}):Play()
			end
		end
	end)
	
	-- Limpar conex√£o quando a janela for destru√≠da
	frame.Destroying:Connect(function()
		if dragConnection then
			dragConnection:Disconnect()
		end
	end)
end

-- Fun√ß√£o para criar elementos
local function Create(className, props)
	local obj = Instance.new(className)
	for prop, val in pairs(props) do
		if prop == "Parent" then
			obj.Parent = val
		else
			obj[prop] = val
		end
	end
	return obj
end

-- Fun√ß√£o principal
function boladolib:CreateWindow(options)
	options = options or {}
	
	local theme = self.Themes[self.Save.Theme]
	
	-- ScreenGui
	local screenGui = Create("ScreenGui", {
		Name = "BoladoHub",
		ResetOnSpawn = false,
		ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
		DisplayOrder = 999,
		Parent = Player:WaitForChild("PlayerGui")
	})
	
	-- Frame principal (VERS√ÉO SIMPLIFICADA PARA TESTE)
	local mainFrame = Create("Frame", {
		Name = "MainFrame",
		Size = UDim2.new(0, 500, 0, 350),
		Position = UDim2.new(0.5, -250, 0.5, -175),
		BackgroundColor3 = Color3.fromRGB(25, 25, 25),
		BackgroundTransparency = 0,
		Parent = screenGui
	})
	
	-- T√≠tulo ARRAST√ÅVEL (GRANDE E VIS√çVEL)
	local titleBar = Create("Frame", {
		Name = "TitleBar",
		Size = UDim2.new(1, 0, 0, 45),
		BackgroundColor3 = Color3.fromRGB(88, 101, 242),  -- AZUL FORTE
		Parent = mainFrame
	})
	
	-- Texto do t√≠tulo
	local titleText = Create("TextLabel", {
		Name = "Title",
		Size = UDim2.new(1, -80, 1, 0),
		Position = UDim2.new(0, 15, 0, 0),
		BackgroundTransparency = 1,
		Text = "üñ±Ô∏è CLIQUE E ARRASTE AQUI! üéÆ",
		TextColor3 = Color3.new(1, 1, 1),
		Font = Enum.Font.GothamBold,
		TextSize = 16,
		TextXAlignment = Enum.TextXAlignment.Left,
		Parent = titleBar
	})
	
	-- Bot√£o fechar
	local closeBtn = Create("TextButton", {
		Name = "Close",
		Size = UDim2.new(0, 35, 0, 35),
		Position = UDim2.new(1, -40, 0.5, -17.5),
		BackgroundColor3 = Color3.fromRGB(255, 60, 60),
		Text = "‚úï",
		TextColor3 = Color3.new(1, 1, 1),
		Font = Enum.Font.GothamBold,
		TextSize = 18,
		AutoButtonColor = false,
		Parent = titleBar
	})
	
	-- √Årea de conte√∫do
	local contentArea = Create("Frame", {
		Name = "ContentArea",
		Size = UDim2.new(1, -20, 1, -65),
		Position = UDim2.new(0, 10, 0, 60),
		BackgroundTransparency = 1,
		Parent = mainFrame
	})
	
	-- Tabs (VIS√çVEIS)
	local tabButtons = Create("Frame", {
		Name = "TabButtons",
		Size = UDim2.new(1, 0, 0, 40),
		BackgroundTransparency = 1,
		Parent = contentArea
	})
	
	-- Conte√∫do das tabs
	local tabContent = Create("Frame", {
		Name = "TabContent",
		Size = UDim2.new(1, 0, 1, -45),
		Position = UDim2.new(0, 0, 0, 45),
		BackgroundTransparency = 1,
		Parent = contentArea
	})
	
	-- CONFIGURAR DRAG (FUNCIONAL GARANTIDO)
	CreateDraggableWindow(mainFrame, titleBar)
	
	-- Testar drag imediatamente
	task.spawn(function()
		task.wait(1)
		print("üéØ TESTE: Clique na barra AZUL e arraste!")
		print("üìç Posi√ß√£o atual:", mainFrame.Position)
	end)
	
	-- Efeitos bot√£o fechar
	closeBtn.MouseButton1Click:Connect(function()
		screenGui:Destroy()
	end)
	
	-- Objeto da janela
	local window = {
		_tabs = {},
		_currentTab = 1,
		_methods = {}
	}
	
	-- M√©todo para criar tab
	function window._methods:CreateTab(tabOptions)
		local options = tabOptions or {}
		local tabId = #window._tabs + 1
		
		-- Bot√£o da tab (VIS√çVEL)
		local tabButton = Create("TextButton", {
			Name = "Tab_" .. tabId,
			Size = UDim2.new(0, 100, 1, 0),
			Position = UDim2.new(0, (tabId-1)*105, 0, 0),
			BackgroundColor3 = tabId == 1 and Color3.fromRGB(88, 101, 242) or Color3.fromRGB(60, 60, 80),
			Text = options.Name or "Tab " .. tabId,
			TextColor3 = tabId == 1 and Color3.new(1, 1, 1) or Color3.new(0.8, 0.8, 0.8),
			Font = Enum.Font.Gotham,
			TextSize = 14,
			AutoButtonColor = false,
			Parent = tabButtons
		})
		
		-- Conte√∫do da tab
		local tabFrame = Create("ScrollingFrame", {
			Name = "TabFrame_" .. tabId,
			Size = UDim2.new(1, 0, 1, 0),
			BackgroundTransparency = 1,
			ScrollBarThickness = 4,
			ScrollBarImageColor3 = Color3.fromRGB(88, 101, 242),
			ScrollingDirection = Enum.ScrollingDirection.Y,
			AutomaticCanvasSize = Enum.AutomaticSize.Y,
			Visible = tabId == 1,
			Parent = tabContent
		})
		
		local tabLayout = Create("UIListLayout", {
			Padding = UDim.new(0, 8),
			SortOrder = Enum.SortOrder.LayoutOrder,
			Parent = tabFrame
		})
		
		-- Selecionar tab
		local function SelectTab()
			for i, tab in pairs(window._tabs) do
				if tab.frame then
					tab.frame.Visible = (i == tabId)
				end
				if tab.button then
					tab.button.BackgroundColor3 = (i == tabId) and Color3.fromRGB(88, 101, 242) or Color3.fromRGB(60, 60, 80)
					tab.button.TextColor3 = (i == tabId) and Color3.new(1, 1, 1) or Color3.new(0.8, 0.8, 0.8)
				end
			end
			window._currentTab = tabId
		end
		
		-- Evento de clique
		tabButton.MouseButton1Click:Connect(SelectTab)
		
		-- M√©todos da tab
		local tabMethods = {}
		
		function tabMethods:CreateButton(btnOptions)
			local button = Create("TextButton", {
				Size = UDim2.new(1, 0, 0, 40),
				BackgroundColor3 = Color3.fromRGB(50, 50, 70),
				Text = btnOptions.Name or "Button",
				TextColor3 = Color3.fromRGB(88, 101, 242),
				Font = Enum.Font.Gotham,
				TextSize = 14,
				AutoButtonColor = false,
				LayoutOrder = #tabFrame:GetChildren(),
				Parent = tabFrame
			})
			
			-- Efeitos
			button.MouseEnter:Connect(function()
				TweenService:Create(button, TweenInfo.new(0.2), {
					BackgroundColor3 = Color3.fromRGB(70, 70, 90)
				}):Play()
			end)
			
			button.MouseLeave:Connect(function()
				TweenService:Create(button, TweenInfo.new(0.2), {
					BackgroundColor3 = Color3.fromRGB(50, 50, 70)
				}):Play()
			end)
			
			-- Clique
			if btnOptions.Callback then
				button.MouseButton1Click:Connect(function()
					pcall(btnOptions.Callback)
				end)
			end
			
			return button
		end
		
		-- Armazenar tab
		local tab = {
			id = tabId,
			button = tabButton,
			frame = tabFrame,
			methods = tabMethods
		}
		
		table.insert(window._tabs, tab)
		
		-- Primeira tab vis√≠vel
		if tabId == 1 then
			SelectTab()
		end
		
		return tabMethods
	end
	
	return window._methods
end

-- Inicializar
function boladolib:Init()
	print("‚úÖ BoladoHub v" .. self.Info.Version .. " - DRAG FUNCIONAL")
	return self
end

return boladolib