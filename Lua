-- BoladoHub v2.1 - OTIMIZADO SEM LAG
local MarketplaceService = game:GetService("MarketplaceService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local PlayerMouse = Player:GetMouse()

local BoladoHub = {
	Themes = {
		Darker = {
			["Color Hub 1"] = ColorSequence.new({
				ColorSequenceKeypoint.new(0.00, Color3.fromRGB(25, 25, 25)),
				ColorSequenceKeypoint.new(0.50, Color3.fromRGB(32.5, 32.5, 32.5)),
				ColorSequenceKeypoint.new(1.00, Color3.fromRGB(25, 25, 25))
			}),
			["Color Hub 2"] = Color3.fromRGB(30, 30, 30),
			["Color Stroke"] = Color3.fromRGB(40, 40, 40),
			["Color Theme"] = Color3.fromRGB(88, 101, 242),
			["Color Text"] = Color3.fromRGB(243, 243, 243),
			["Color Dark Text"] = Color3.fromRGB(180, 180, 180)
		}
	},
	Info = {
		Version = "2.1.0",
		Author = "BoladoHub"
	},
	Save = {
		UISize = {580, 420},
		TabSize = 170,
		Theme = "Darker",
		Minimized = false
	},
	Settings = {},
	Connection = {},
	Instances = {},
	Elements = {},
	Options = {},
	Flags = {},
	Tabs = {},
	Icons = {
		["sword"] = "rbxassetid://10734975486",
		["eye"] = "rbxassetid://10723346959",
		["user"] = "rbxassetid://10747373176",
		["settings"] = "rbxassetid://10734950309",
		["star"] = "rbxassetid://10734966248",
		["bolt"] = "rbxassetid://10709721749"
	}
}

-- FUN√á√ÉO OTIMIZADA PARA CRIAR ELEMENTOS
local function CreateElement(className, properties)
	local element = Instance.new(className)
	for property, value in pairs(properties) do
		if property == "Parent" then
			element.Parent = value
		else
			element[property] = value
		end
	end
	return element
end

-- SISTEMA DE DRAG OTIMIZADO (SEM LAG)
local function SetupDraggable(frame, handle)
	local dragging = false
	local dragStart, frameStart
	local dragConnection
	
	-- Fun√ß√£o para iniciar drag (OTIMIZADA)
	local function BeginDrag(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or 
		   input.UserInputType == Enum.UserInputType.Touch then
			
			dragging = true
			dragStart = input.Position
			frameStart = frame.Position
			
			-- Efeito visual leve
			handle.BackgroundTransparency = 0.2
		end
	end
	
	-- Fun√ß√£o para atualizar drag (OTIMIZADA - usa Heartbeat em vez de RenderStepped)
	local function UpdateDrag()
		if dragging then
			local mousePos
			
			-- Para mouse
			if UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton1) then
				mousePos = Vector2.new(PlayerMouse.X, PlayerMouse.Y)
			-- Para touch
			elseif UserInputService.TouchEnabled then
				local touchPoints = UserInputService:GetConnectedTouchPoints()
				if #touchPoints > 0 then
					mousePos = touchPoints[1].Position
				else
					dragging = false
					handle.BackgroundTransparency = 0
					if dragConnection then
						dragConnection:Disconnect()
					end
					return
				end
			else
				dragging = false
				handle.BackgroundTransparency = 0
				if dragConnection then
					dragConnection:Disconnect()
				end
				return
			end
			
			local delta = mousePos - dragStart
			frame.Position = UDim2.new(
				frameStart.X.Scale,
				frameStart.X.Offset + delta.X,
				frameStart.Y.Scale,
				frameStart.Y.Offset + delta.Y
			)
		end
	end
	
	-- Conectar eventos
	handle.InputBegan:Connect(BeginDrag)
	
	handle.InputEnded:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or 
		   input.UserInputType == Enum.UserInputType.Touch then
			dragging = false
			handle.BackgroundTransparency = 0
			
			if dragConnection then
				dragConnection:Disconnect()
				dragConnection = nil
			end
		end
	end)
	
	-- Usar Heartbeat (menos intensivo que RenderStepped)
	handle.InputBegan:Connect(function(input)
		if (input.UserInputType == Enum.UserInputType.MouseButton1 or 
			input.UserInputType == Enum.UserInputType.Touch) and not dragConnection then
			
			dragConnection = RunService.Heartbeat:Connect(UpdateDrag)
		end
	end)
	
	-- Limpar conex√£o
	frame.Destroying:Connect(function()
		if dragConnection then
			dragConnection:Disconnect()
		end
	end)
end

-- FUN√á√ÉO PRINCIPAL SIMPLIFICADA E OTIMIZADA
function BoladoHub:CreateWindow(options)
	options = options or {}
	
	local theme = self.Themes[self.Save.Theme]
	
	-- ScreenGui
	local screenGui = CreateElement("ScreenGui", {
		Name = "BoladoHubUI",
		ResetOnSpawn = false,
		ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
		Parent = Player:WaitForChild("PlayerGui")
	})
	
	-- Frame principal (SIMPLIFICADO PARA TESTE)
	local mainFrame = CreateElement("Frame", {
		Name = "MainFrame",
		Size = UDim2.new(0, 500, 0, 400), -- Tamanho menor para teste
		Position = UDim2.new(0.5, -250, 0.5, -200),
		BackgroundColor3 = theme["Color Hub 2"],
		BackgroundTransparency = 0,
		Parent = screenGui
	})
	
	local uiCorner = CreateElement("UICorner", {
		CornerRadius = UDim.new(0, 10),
		Parent = mainFrame
	})
	
	local uiStroke = CreateElement("UIStroke", {
		Color = theme["Color Theme"],
		Thickness = 2,
		Parent = mainFrame
	})
	
	-- Barra de t√≠tulo (SIMPLES E VIS√çVEL)
	local titleBar = CreateElement("Frame", {
		Name = "TitleBar",
		Size = UDim2.new(1, 0, 0, 40),
		BackgroundColor3 = theme["Color Theme"], -- COR FORTE PARA VISIBILIDADE
		Parent = mainFrame
	})
	
	-- T√≠tulo GRANDE E VIS√çVEL
	local titleText = CreateElement("TextLabel", {
		Name = "Title",
		Size = UDim2.new(1, -100, 1, 0),
		Position = UDim2.new(0, 10, 0, 0),
		BackgroundTransparency = 1,
		Text = "üéÆ BOLADOHUB üéÆ",
		TextColor3 = Color3.new(1, 1, 1),
		Font = Enum.Font.GothamBold,
		TextSize = 18,
		TextXAlignment = Enum.TextXAlignment.Left,
		Parent = titleBar
	})
	
	-- Bot√µes da barra
	local titleButtons = CreateElement("Frame", {
		Name = "TitleButtons",
		Size = UDim2.new(0, 80, 1, 0),
		Position = UDim2.new(1, -85, 0, 0),
		BackgroundTransparency = 1,
		Parent = titleBar
	})
	
	-- Bot√£o minimizar
	local minimizeBtn = CreateElement("TextButton", {
		Name = "Minimize",
		Size = UDim2.new(0, 30, 0, 30),
		Position = UDim2.new(0, 0, 0.5, -15),
		BackgroundColor3 = Color3.fromRGB(255, 180, 0),
		Text = "_",
		TextColor3 = Color3.new(1, 1, 1),
		Font = Enum.Font.GothamBold,
		TextSize = 14,
		AutoButtonColor = false,
		Parent = titleButtons
	})
	
	-- Bot√£o fechar
	local closeBtn = CreateElement("TextButton", {
		Name = "Close",
		Size = UDim2.new(0, 30, 0, 30),
		Position = UDim2.new(1, -35, 0.5, -15),
		BackgroundColor3 = Color3.fromRGB(255, 60, 60),
		Text = "‚úï",
		TextColor3 = Color3.new(1, 1, 1),
		Font = Enum.Font.GothamBold,
		TextSize = 16,
		AutoButtonColor = false,
		Parent = titleButtons
	})
	
	-- √Årea de conte√∫do VIS√çVEL
	local contentArea = CreateElement("Frame", {
		Name = "ContentArea",
		Size = UDim2.new(1, -20, 1, -60),
		Position = UDim2.new(0, 10, 0, 55),
		BackgroundColor3 = Color3.fromRGB(40, 40, 40), -- FUNDO VIS√çVEL
		BackgroundTransparency = 0, -- N√ÉO TRANSPARENTE
		Parent = mainFrame
	})
	
	local contentCorner = CreateElement("UICorner", {
		CornerRadius = UDim.new(0, 8),
		Parent = contentArea
	})
	
	-- Tabs VIS√çVEIS
	local tabButtons = CreateElement("Frame", {
		Name = "TabButtons",
		Size = UDim2.new(1, 0, 0, 40),
		BackgroundTransparency = 1,
		Parent = contentArea
	})
	
	-- Conte√∫do das tabs VIS√çVEL
	local tabContent = CreateElement("Frame", {
		Name = "TabContent",
		Size = UDim2.new(1, 0, 1, -45),
		Position = UDim2.new(0, 0, 0, 45),
		BackgroundColor3 = Color3.fromRGB(50, 50, 50), -- FUNDO VIS√çVEL
		BackgroundTransparency = 0, -- N√ÉO TRANSPARENTE
		Parent = contentArea
	})
	
	local tabContentCorner = CreateElement("UICorner", {
		CornerRadius = UDim.new(0, 8),
		Parent = tabContent
	})
	
	-- CONFIGURAR DRAG OTIMIZADO
	SetupDraggable(mainFrame, titleBar)
	
	-- Sistema de minimizar
	local minimized = false
	local originalSize = mainFrame.Size
	
	minimizeBtn.MouseButton1Click:Connect(function()
		minimized = not minimized
		
		if minimized then
			-- Minimizar
			TweenService:Create(mainFrame, TweenInfo.new(0.3), {
				Size = UDim2.new(0, 300, 0, 40)
			}):Play()
			
			contentArea.Visible = false
			minimizeBtn.Text = "‚ñ°"
		else
			-- Maximizar
			TweenService:Create(mainFrame, TweenInfo.new(0.3), {
				Size = originalSize
			}):Play()
			
			contentArea.Visible = true
			minimizeBtn.Text = "_"
		end
	end)
	
	-- Efeitos simples para bot√µes
	local function SimpleButtonEffect(button, hoverColor)
		button.MouseEnter:Connect(function()
			button.BackgroundColor3 = hoverColor
		end)
		
		button.MouseLeave:Connect(function()
			button.BackgroundColor3 = button.Name == "Close" and Color3.fromRGB(255, 60, 60) or Color3.fromRGB(255, 180, 0)
		end)
	end
	
	SimpleButtonEffect(minimizeBtn, Color3.fromRGB(255, 220, 100))
	SimpleButtonEffect(closeBtn, Color3.fromRGB(255, 100, 100))
	
	-- Fechar
	closeBtn.MouseButton1Click:Connect(function()
		screenGui:Destroy()
	end)
	
	-- Objeto da janela
	local window = {
		_instance = mainFrame,
		_screenGui = screenGui,
		_tabs = {},
		_currentTab = 1,
		_methods = {}
	}
	
	-- Fun√ß√£o para criar bot√£o SIMPLES E VIS√çVEL
	function window._methods:CreateButton(btnOptions)
		local options = btnOptions or {}
		
		local button = CreateElement("TextButton", {
			Size = UDim2.new(1, -20, 0, 45),
			Position = UDim2.new(0, 10, 0, (#tabContent:GetChildren() * 55) + 10),
			BackgroundColor3 = theme["Color Hub 2"],
			Text = options.Name or "BOT√ÉO TESTE",
			TextColor3 = theme["Color Theme"],
			Font = Enum.Font.GothamBold,
			TextSize = 14,
			AutoButtonColor = false,
			Parent = tabContent
		})
		
		local btnCorner = CreateElement("UICorner", {
			CornerRadius = UDim.new(0, 8),
			Parent = button
		})
		
		-- Efeitos SIMPLES
		button.MouseEnter:Connect(function()
			button.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
		end)
		
		button.MouseLeave:Connect(function()
			button.BackgroundColor3 = theme["Color Hub 2"]
		end)
		
		-- Clique
		if options.Callback then
			button.MouseButton1Click:Connect(function()
				pcall(options.Callback)
			end)
		end
		
		return button
	end
	
	-- Fun√ß√£o para criar tab SIMPLES E VIS√çVEL
	function window._methods:CreateTab(tabOptions)
		local options = tabOptions or {}
		local tabId = #window._tabs + 1
		
		-- Bot√£o da tab VIS√çVEL
		local tabButton = CreateElement("TextButton", {
			Name = "Tab_" .. tabId,
			Size = UDim2.new(0, 100, 1, 0),
			Position = UDim2.new(0, (tabId-1)*105, 0, 0),
			BackgroundColor3 = tabId == 1 and theme["Color Theme"] or Color3.fromRGB(60, 60, 80),
			Text = options.Name or "TAB " .. tabId,
			TextColor3 = Color3.new(1, 1, 1),
			Font = Enum.Font.GothamBold,
			TextSize = 13,
			AutoButtonColor = false,
			Parent = tabButtons
		})
		
		-- Limpar conte√∫do anterior (s√≥ uma tab vis√≠vel por vez)
		if tabId == 1 then
			tabContent:ClearAllChildren()
			
			-- Criar bot√£o de teste automaticamente
			window._methods:CreateButton({
				Name = "‚úÖ BOT√ÉO FUNCIONAL",
				Callback = function()
					print("üéØ Bot√£o funcionando!")
				end
			})
		end
		
		-- Evento de clique na tab
		tabButton.MouseButton1Click:Connect(function()
			-- Atualizar cores
			for i, tab in pairs(window._tabs) do
				tab.button.BackgroundColor3 = (i == tabId) and theme["Color Theme"] or Color3.fromRGB(60, 60, 80)
			end
			
			-- Limpar e criar conte√∫do
			tabContent:ClearAllChildren()
			
			-- Criar bot√£o de teste
			window._methods:CreateButton({
				Name = "üéÆ TAB " .. tabId .. " ATIVA",
				Callback = function()
					print("Tab " .. tabId .. " funcionando!")
				end
			})
			
			window._currentTab = tabId
		end)
		
		table.insert(window._tabs, {button = tabButton})
		
		return window._methods
	end
	
	-- M√©todos adicionais
	function window._methods:Destroy()
		screenGui:Destroy()
	end
	
	function window._methods:Show()
		mainFrame.Visible = true
	end
	
	function window._methods:Hide()
		mainFrame.Visible = false
	end
	
	-- Criar primeira tab automaticamente
	window._methods:CreateTab({Name = "COMBATE"})
	
	return window._methods
end

-- Inicializa√ß√£o
function BoladoHub:Init()
	print("üöÄ BoladoHub v" .. self.Info.Version .. " - OTIMIZADO SEM LAG")
	return self
end

return BoladoHub