-- BoladoHub v3.0 - SUPER OTIMIZADO & VIS√çVEL
local MarketplaceService = game:GetService("MarketplaceService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local PlayerMouse = Player:GetMouse()

local BoladoHub = {
    Themes = {
        Darker = {
            ["MainColor"] = Color3.fromRGB(30, 30, 40),
            ["SecondaryColor"] = Color3.fromRGB(40, 40, 50),
            ["AccentColor"] = Color3.fromRGB(88, 101, 242),
            ["TextColor"] = Color3.fromRGB(255, 255, 255),
            ["SubTextColor"] = Color3.fromRGB(180, 180, 180)
        },
        Light = {
            ["MainColor"] = Color3.fromRGB(240, 240, 245),
            ["SecondaryColor"] = Color3.fromRGB(255, 255, 255),
            ["AccentColor"] = Color3.fromRGB(0, 122, 255),
            ["TextColor"] = Color3.fromRGB(30, 30, 30),
            ["SubTextColor"] = Color3.fromRGB(100, 100, 100)
        }
    },
    Info = {
        Version = "3.0.0",
        Author = "BoladoHub"
    },
    CurrentTheme = "Darker",
    Instances = {},
    UIObjects = {},
    ActiveTabs = {}
}

-- üîß FUN√á√ÉO OTIMIZADA PARA CRIAR ELEMENTOS
local function CreateElement(className, properties, children)
    local element = Instance.new(className)
    
    -- Aplicar propriedades
    for property, value in pairs(properties) do
        if property == "Parent" then
            element.Parent = value
        else
            local success, err = pcall(function()
                element[property] = value
            end)
            if not success then
                warn("Erro ao definir propriedade", property, ":", err)
            end
        end
    end
    
    -- Adicionar filhos
    if children then
        for _, child in pairs(children) do
            child.Parent = element
        end
    end
    
    return element
end

-- üéØ SISTEMA DE DRAG ULTRA OTIMIZADO
local function CreateDraggable(frame, handle)
    local dragging, dragStart, frameStart, dragConnection = false
    
    -- Otimizado: usa evento √∫nico em vez de m√∫ltiplos
    handle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            frameStart = frame.Position
            
            -- Efeito visual sutil
            if handle:IsA("GuiObject") then
                TweenService:Create(handle, TweenInfo.new(0.1), {
                    BackgroundTransparency = 0.9
                }):Play()
            end
            
            -- Conex√£o otimizada (usando Heartbeat)
            dragConnection = RunService.Heartbeat:Connect(function()
                if dragging then
                    local mousePos = UserInputService:GetMouseLocation()
                    local delta = mousePos - dragStart
                    
                    frame.Position = UDim2.new(
                        frameStart.X.Scale,
                        math.clamp(frameStart.X.Offset + delta.X, 0, workspace.CurrentCamera.ViewportSize.X - frame.AbsoluteSize.X),
                        frameStart.Y.Scale,
                        math.clamp(frameStart.Y.Offset + delta.Y, 0, workspace.CurrentCamera.ViewportSize.Y - frame.AbsoluteSize.Y)
                    )
                end
            end)
        end
    end)
    
    -- Otimizado: usa eventos globais
    local function EndDrag()
        dragging = false
        if dragConnection then
            dragConnection:Disconnect()
            dragConnection = nil
        end
        
        if handle:IsA("GuiObject") then
            TweenService:Create(handle, TweenInfo.new(0.1), {
                BackgroundTransparency = 1
            }):Play()
        end
    end
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            EndDrag()
        end
    end)
    
    -- Cleanup
    frame.Destroying:Connect(EndDrag)
end

-- üé® SISTEMA DE TABS OTIMIZADO
local TabSystem = {}
TabSystem.__index = TabSystem

function TabSystem.new(container)
    local self = setmetatable({
        Container = container,
        Tabs = {},
        CurrentTab = nil,
        TabButtons = CreateElement("Frame", {
            Name = "TabButtons",
            Size = UDim2.new(1, 0, 0, 40),
            BackgroundTransparency = 1,
            Parent = container
        }, {
            CreateElement("UIListLayout", {
                FillDirection = Enum.FillDirection.Horizontal,
                Padding = UDim.new(0, 5)
            })
        })
    }, TabSystem)
    
    return self
end

function TabSystem:AddTab(name, icon)
    local theme = BoladoHub.Themes[BoladoHub.CurrentTheme]
    local tabId = #self.Tabs + 1
    
    -- Bot√£o da Tab
    local tabButton = CreateElement("TextButton", {
        Name = "Tab_" .. tabId,
        Size = UDim2.new(0, 120, 1, 0),
        BackgroundColor3 = theme.SecondaryColor,
        Text = icon and (icon .. " " .. name) or name,
        TextColor3 = theme.TextColor,
        Font = Enum.Font.GothamBold,
        TextSize = 14,
        AutoButtonColor = false
    }, {
        CreateElement("UICorner", {CornerRadius = UDim.new(0, 6)}),
        CreateElement("UIStroke", {
            Color = theme.AccentColor,
            Thickness = 1
        })
    })
    
    tabButton.Parent = self.TabButtons
    
    -- Conte√∫do da Tab
    local tabContent = CreateElement("ScrollingFrame", {
        Name = "TabContent_" .. tabId,
        Size = UDim2.new(1, -20, 1, -50),
        Position = UDim2.new(0, 10, 0, 50),
        BackgroundTransparency = 1,
        ScrollBarImageColor3 = theme.AccentColor,
        ScrollBarThickness = 4,
        Visible = false,
        Parent = self.Container
    }, {
        CreateElement("UIListLayout", {
            SortOrder = Enum.SortOrder.LayoutOrder,
            Padding = UDim.new(0, 10)
        }),
        CreateElement("UIPadding", {
            PaddingTop = UDim.new(0, 10),
            PaddingLeft = UDim.new(0, 5),
            PaddingRight = UDim.new(0, 5)
        })
    })
    
    -- Efeitos do bot√£o
    tabButton.MouseEnter:Connect(function()
        TweenService:Create(tabButton, TweenInfo.new(0.2), {
            BackgroundColor3 = Color3.fromRGB(60, 70, 85)
        }):Play()
    end)
    
    tabButton.MouseLeave:Connect(function()
        TweenService:Create(tabButton, TweenInfo.new(0.2), {
            BackgroundColor3 = self.CurrentTab == tabId and theme.AccentColor or theme.SecondaryColor
        }):Play()
    end)
    
    -- Clique na Tab
    tabButton.MouseButton1Click:Connect(function()
        self:SwitchTab(tabId)
    end)
    
    -- Armazenar tab
    local tab = {
        Id = tabId,
        Button = tabButton,
        Content = tabContent,
        Elements = {}
    }
    
    table.insert(self.Tabs, tab)
    
    -- Se for a primeira tab, ativar
    if #self.Tabs == 1 then
        self:SwitchTab(1)
    end
    
    return {
        AddButton = function(options)
            return self:CreateButton(tabId, options)
        end,
        AddLabel = function(options)
            return self:CreateLabel(tabId, options)
        end,
        AddToggle = function(options)
            return self:CreateToggle(tabId, options)
        end,
        AddSlider = function(options)
            return self:CreateSlider(tabId, options)
        end
    }
end

function TabSystem:SwitchTab(tabId)
    if self.CurrentTab == tabId then return end
    
    local theme = BoladoHub.Themes[BoladoHub.CurrentTheme]
    
    -- Atualizar bot√µes
    for i, tab in ipairs(self.Tabs) do
        tab.Content.Visible = (i == tabId)
        TweenService:Create(tab.Button, TweenInfo.new(0.3), {
            BackgroundColor3 = (i == tabId) and theme.AccentColor or theme.SecondaryColor,
            Size = UDim2.new(0, (i == tabId) and 140 or 120, 1, 0)
        }):Play()
    end
    
    self.CurrentTab = tabId
end

-- üìã COMPONENTES DA UI (OTIMIZADOS)
function TabSystem:CreateButton(tabId, options)
    local theme = BoladoHub.Themes[BoladoHub.CurrentTheme]
    local tab = self.Tabs[tabId]
    
    local button = CreateElement("TextButton", {
        Name = "Button_" .. #tab.Elements + 1,
        Size = UDim2.new(1, 0, 0, 45),
        BackgroundColor3 = theme.SecondaryColor,
        Text = options.Text or "Button",
        TextColor3 = theme.TextColor,
        Font = Enum.Font.GothamSemibold,
        TextSize = 14,
        LayoutOrder = #tab.Elements + 1,
        AutoButtonColor = false
    }, {
        CreateElement("UICorner", {CornerRadius = UDim.new(0, 8)}),
        CreateElement("UIStroke", {
            Color = theme.AccentColor,
            Thickness = 1
        })
    })
    
    button.Parent = tab.Content
    table.insert(tab.Elements, button)
    
    -- Efeitos
    button.MouseEnter:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.2), {
            BackgroundColor3 = Color3.fromRGB(70, 80, 95),
            Size = UDim2.new(1, 10, 0, 45)
        }):Play()
    end)
    
    button.MouseLeave:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.2), {
            BackgroundColor3 = theme.SecondaryColor,
            Size = UDim2.new(1, 0, 0, 45)
        }):Play()
    end)
    
    -- Clique
    if options.Callback and type(options.Callback) == "function" then
        button.MouseButton1Click:Connect(function()
            task.spawn(function() -- Evita travar a UI
                pcall(options.Callback)
            end)
        end)
    end
    
    return button
end

function TabSystem:CreateLabel(tabId, options)
    local theme = BoladoHub.Themes[BoladoHub.CurrentTheme]
    local tab = self.Tabs[tabId]
    
    local label = CreateElement("TextLabel", {
        Name = "Label_" .. #tab.Elements + 1,
        Size = UDim2.new(1, 0, 0, 30),
        BackgroundTransparency = 1,
        Text = options.Text or "Label",
        TextColor3 = options.Color or theme.TextColor,
        Font = Enum.Font.GothamBold,
        TextSize = options.Size or 16,
        TextXAlignment = Enum.TextXAlignment.Left,
        LayoutOrder = #tab.Elements + 1
    })
    
    label.Parent = tab.Content
    table.insert(tab.Elements, label)
    
    return label
end

-- ü™ü FUN√á√ÉO PRINCIPAL PARA CRIAR JANELA
function BoladoHub:CreateWindow(options)
    options = options or {}
    local theme = self.Themes[self.CurrentTheme]
    
    -- üé≠ SCREEN GUI PRINCIPAL
    local screenGui = CreateElement("ScreenGui", {
        Name = "BoladoHub_" .. HttpService:GenerateGUID(false):sub(1, 8),
        ResetOnSpawn = false,
        ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
        DisplayOrder = 999
    })
    
    -- Prote√ß√£o contra m√∫ltiplas inst√¢ncias
    if CoreGui:FindFirstChild(screenGui.Name) then
        CoreGui:FindFirstChild(screenGui.Name):Destroy()
    end
    screenGui.Parent = CoreGui
    
    -- üñºÔ∏è FRAME PRINCIPAL
    local mainFrame = CreateElement("Frame", {
        Name = "MainWindow",
        Size = UDim2.new(0, 550, 0, 450),
        Position = UDim2.new(0.5, -275, 0.5, -225),
        BackgroundColor3 = theme.MainColor,
        ClipsDescendants = true
    }, {
        CreateElement("UICorner", {CornerRadius = UDim.new(0, 12)}),
        CreateElement("UIStroke", {
            Color = theme.AccentColor,
            Thickness = 2,
            Transparency = 0.2
        }),
        CreateElement("UIGradient", {
            Color = ColorSequence.new({
                ColorSequenceKeypoint.new(0, theme.MainColor),
                ColorSequenceKeypoint.new(1, Color3.fromRGB(
                    theme.MainColor.R * 255 * 0.9,
                    theme.MainColor.G * 255 * 0.9,
                    theme.MainColor.B * 255 * 0.9
                ))
            }),
            Rotation = 45
        })
    })
    
    mainFrame.Parent = screenGui
    
    -- üéØ BARRA DE T√çTULO
    local titleBar = CreateElement("Frame", {
        Name = "TitleBar",
        Size = UDim2.new(1, 0, 0, 45),
        BackgroundColor3 = theme.AccentColor
    }, {
        CreateElement("UICorner", {
            CornerRadius = UDim.new(0, 12),
            CornerMask = UDim.new(0, 0b1001)
        }),
        CreateElement("UIGradient", {
            Color = ColorSequence.new({
                ColorSequenceKeypoint.new(0, theme.AccentColor),
                ColorSequenceKeypoint.new(1, Color3.fromRGB(
                    math.min(theme.AccentColor.R * 255 + 20, 255),
                    math.min(theme.AccentColor.G * 255 + 20, 255),
                    math.min(theme.AccentColor.B * 255 + 20, 255)
                ))
            })
        })
    })
    
    titleBar.Parent = mainFrame
    
    -- üìõ T√çTULO DA JANELA
    local titleLabel = CreateElement("TextLabel", {
        Name = "Title",
        Size = UDim2.new(1, -100, 1, 0),
        Position = UDim2.new(0, 15, 0, 0),
        BackgroundTransparency = 1,
        Text = "üöÄ BOLADO HUB v3.0",
        TextColor3 = Color3.new(1, 1, 1),
        Font = Enum.Font.GothamBlack,
        TextSize = 18,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    titleLabel.Parent = titleBar
    
    -- üîò BOT√ïES DA BARRA
    local buttonContainer = CreateElement("Frame", {
        Name = "WindowButtons",
        Size = UDim2.new(0, 80, 1, 0),
        Position = UDim2.new(1, -85, 0, 0),
        BackgroundTransparency = 1
    }, {
        CreateElement("UIListLayout", {
            FillDirection = Enum.FillDirection.Horizontal,
            Padding = UDim.new(0, 5),
            HorizontalAlignment = Enum.HorizontalAlignment.Right
        })
    })
    
    buttonContainer.Parent = titleBar
    
    -- Bot√£o Minimizar
    local minimizeBtn = CreateElement("TextButton", {
        Name = "Minimize",
        Size = UDim2.new(0, 35, 0, 35),
        BackgroundColor3 = Color3.fromRGB(255, 193, 7),
        Text = "‚îÄ",
        TextColor3 = Color3.new(0, 0, 0),
        Font = Enum.Font.GothamBold,
        TextSize = 16,
        AutoButtonColor = false
    }, {
        CreateElement("UICorner", {CornerRadius = UDim.new(0, 6)})
    })
    
    -- Bot√£o Fechar
    local closeBtn = CreateElement("TextButton", {
        Name = "Close",
        Size = UDim2.new(0, 35, 0, 35),
        BackgroundColor3 = Color3.fromRGB(244, 67, 54),
        Text = "‚úï",
        TextColor3 = Color3.new(1, 1, 1),
        Font = Enum.Font.GothamBold,
        TextSize = 16,
        AutoButtonColor = false
    }, {
        CreateElement("UICorner", {CornerRadius = UDim.new(0, 6)})
    })
    
    minimizeBtn.Parent = buttonContainer
    closeBtn.Parent = buttonContainer
    
    -- üéÆ √ÅREA DE CONTE√öDO
    local contentFrame = CreateElement("Frame", {
        Name = "ContentFrame",
        Size = UDim2.new(1, -20, 1, -65),
        Position = UDim2.new(0, 10, 0, 60),
        BackgroundColor3 = Color3.fromRGB(35, 35, 45),
        BackgroundTransparency = 0.1
    }, {
        CreateElement("UICorner", {CornerRadius = UDim.new(0, 10)}),
        CreateElement("UIStroke", {
            Color = Color3.fromRGB(60, 60, 70),
            Thickness = 1
        })
    })
    
    contentFrame.Parent = mainFrame
    
    -- üì± CONFIGURAR DRAGGABLE
    CreateDraggable(mainFrame, titleBar)
    
    -- üé™ SISTEMA DE TABS
    local tabSystem = TabSystem.new(contentFrame)
    
    -- ‚öôÔ∏è CONFIGURAR EVENTOS DOS BOT√ïES
    -- Minimizar
    local minimized = false
    local originalSize = mainFrame.Size
    
    minimizeBtn.MouseButton1Click:Connect(function()
        minimized = not minimized
        
        TweenService:Create(mainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
            Size = minimized and UDim2.new(0, 300, 0, 45) or originalSize
        }):Play()
        
        TweenService:Create(contentFrame, TweenInfo.new(0.2), {
            BackgroundTransparency = minimized and 1 or 0.1
        }):Play()
    end)
    
    -- Fechar com anima√ß√£o
    closeBtn.MouseButton1Click:Connect(function()
        TweenService:Create(mainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
            Size = UDim2.new(0, 0, 0, 0),
            Position = UDim2.new(0.5, 0, 0.5, 0)
        }):Play()
        
        task.wait(0.3)
        screenGui:Destroy()
    end)
    
    -- üé≠ EFEITOS NOS BOT√ïES
    local function SetupButtonEffects(button, hoverColor, clickColor)
        button.MouseEnter:Connect(function()
            TweenService:Create(button, TweenInfo.new(0.2), {
                BackgroundColor3 = hoverColor,
                Size = UDim2.new(0, 40, 0, 40)
            }):Play()
        end)
        
        button.MouseLeave:Connect(function()
            local defaultColor = button.Name == "Close" and Color3.fromRGB(244, 67, 54) 
                               or Color3.fromRGB(255, 193, 7)
            TweenService:Create(button, TweenInfo.new(0.2), {
                BackgroundColor3 = defaultColor,
                Size = UDim2.new(0, 35, 0, 35)
            }):Play()
        end)
        
        button.MouseButton1Down:Connect(function()
            TweenService:Create(button, TweenInfo.new(0.1), {
                BackgroundColor3 = clickColor,
                Size = UDim2.new(0, 32, 0, 32)
            }):Play()
        end)
        
        button.MouseButton1Up:Connect(function()
            TweenService:Create(button, TweenInfo.new(0.1), {
                BackgroundColor3 = hoverColor,
                Size = UDim2.new(0, 40, 0, 40)
            }):Play()
        end)
    end
    
    SetupButtonEffects(minimizeBtn, 
        Color3.fromRGB(255, 213, 79), 
        Color3.fromRGB(255, 202, 40))
    
    SetupButtonEffects(closeBtn, 
        Color3.fromRGB(255, 87, 68), 
        Color3.fromRGB(229, 57, 53))
    
    -- üé™ RETORNAR INTERFACE DA JANELA
    local windowInterface = {}
    
    function windowInterface:AddTab(name, icon)
        return tabSystem:AddTab(name, icon)
    end
    
    function windowInterface:Destroy()
        if screenGui then
            screenGui:Destroy()
        end
    end
    
    function windowInterface:Hide()
        mainFrame.Visible = false
    end
    
    function windowInterface:Show()
        mainFrame.Visible = true
    end
    
    function windowInterface:SetTheme(themeName)
        if self.Themes[themeName] then
            self.CurrentTheme = themeName
            -- Implementar mudan√ßa de tema din√¢mica
        end
    end
    
    -- üì± CRIAR TABS EXEMPLO (AUTO-CRIA√á√ÉO)
    task.spawn(function()
        -- Tab 1: COMBATE
        local combatTab = windowInterface:AddTab("COMBATE", "‚öîÔ∏è")
        combatTab:AddLabel({Text = "üî´ CONFIGURA√á√ïES DE COMBATE", Size = 18})
        combatTab:AddButton({
            Text = "üî• AUTO-ATAQUE",
            Callback = function()
                print("Auto-ataque ativado!")
            end
        })
        combatTab:AddButton({
            Text = "üéØ AIMBOT",
            Callback = function()
                print("Aimbot ativado!")
            end
        })
        
        -- Tab 2: VISUAIS
        local visualTab = windowInterface:AddTab("VISUAIS", "üëÅÔ∏è")
        visualTab:AddLabel({Text = "üé® EFEITOS VISUAIS", Size = 18})
        visualTab:AddButton({
            Text = "üåà ESPECTRO",
            Callback = function()
                print("Espectro ativado!")
            end
        })
        
        -- Tab 3: JOGADOR
        local playerTab = windowInterface:AddTab("JOGADOR", "üë§")
        playerTab:AddLabel({Text = "üèÉ MOVIMENTA√á√ÉO", Size = 18})
        playerTab:AddButton({
            Text = "‚ö° VELOCIDADE",
            Callback = function()
                print("Velocidade aumentada!")
            end
        })
    end)
    
    -- üìä LOADER ANIMADO
    local loader = CreateElement("Frame", {
        Name = "Loader",
        Size = UDim2.new(1, 0, 0, 3),
        Position = UDim2.new(0, 0, 1, -3),
        BackgroundColor3 = theme.AccentColor,
        BorderSizePixel = 0
    })
    
    loader.Parent = mainFrame
    
    -- Anima√ß√£o do loader
    task.spawn(function()
        while loader and loader.Parent do
            for i = 0, 100, 5 do
                if not loader then break end
                loader.Size = UDim2.new(0, i/100 * mainFrame.AbsoluteSize.X, 0, 3)
                task.wait(0.05)
            end
            loader.Size = UDim2.new(0, 0, 0, 3)
            task.wait(0.5)
        end
    end)
    
    -- Armazenar refer√™ncia
    table.insert(self.UIObjects, {
        Gui = screenGui,
        Window = windowInterface
    })
    
    print("‚úÖ BoladoHub v3.0 carregado com sucesso!")
    print("üéÆ Tabs criadas: COMBATE, VISUAIS, JOGADOR")
    print("‚ö° Performance otimizada - 0 lag")
    
    return windowInterface
end

-- üöÄ INICIALIZADOR
function BoladoHub:Init()
    print("====================================")
    print("üöÄ BOLADO HUB v" .. self.Info.Version)
    print("üë®‚Äçüíª Autor: " .. self.Info.Author)
    print("üé® Temas: Darker, Light")
    print("‚ö° Status: Otimizado para performance")
    print("====================================")
    
    return self
end

-- üì± EXEMPLO DE USO
-- local hub = BoladoHub:Init()
-- local window = hub:CreateWindow({Title = "Meu Hub"})

return BoladoHub:Init()