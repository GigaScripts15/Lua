-- BoladoHub v5.1 - DRAG FUNCIONAL GARANTIDO
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local BoladoHub = {}

-- Sistema de Drag SIMPLES e FUNCIONAL
local function CreateDraggableWindow(frame, dragHandle)
    local dragging = true
    local dragStart
    local startPos
    
    -- Mouse Down
    dragHandle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or 
           input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            
            -- Efeito visual de estar arrastando
            TweenService:Create(dragHandle, TweenInfo.new(0.1), {
                BackgroundTransparency = 0.5
            }):Play()
        end
    end)
    
    -- Mouse Move (ATUALIZADO - Funciona corretamente)
    local connection
    connection = RunService.RenderStepped:Connect(function()
        if dragging and UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton1) then
            local mouse = game:GetService("Players").LocalPlayer:GetMouse()
            local delta = Vector2.new(mouse.X, mouse.Y) - dragStart
            frame.Position = UDim2.new(
                startPos.X.Scale,
                startPos.X.Offset + delta.X,
                startPos.Y.Scale,
                startPos.Y.Offset + delta.Y
            )
        elseif dragging and #UserInputService:GetConnectedTouchPoints() > 0 then
            -- Para touch
            local touch = UserInputService:GetConnectedTouchPoints()[1]
            local delta = touch.Position - dragStart
            frame.Position = UDim2.new(
                startPos.X.Scale,
                startPos.X.Offset + delta.X,
                startPos.Y.Scale,
                startPos.Y.Offset + delta.Y
            )
        end
    end)
    
    -- Mouse Up
    dragHandle.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or 
           input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
            
            -- Restaurar transpar√™ncia
            TweenService:Create(dragHandle, TweenInfo.new(0.1), {
                BackgroundTransparency = 0
            }):Play()
        end
    end)
    
    -- Limpar conex√£o quando a janela for destru√≠da
    frame.Destroying:Connect(function()
        if connection then
            connection:Disconnect()
        end
    end)
end

-- Fun√ß√£o principal SIMPLIFICADA
function BoladoHub:CreateWindow(options)
    options = options or {}
    
    local player = Players.LocalPlayer
    local playerGui = player:WaitForChild("PlayerGui")
    
    -- Remover UIs antigas
    local oldUI = playerGui:FindFirstChild("BoladoHub_Main")
    if oldUI then oldUI:Destroy() end
    
    -- ScreenGui
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "BoladoHub_Main"
    screenGui.ResetOnSpawn = false
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Global
    screenGui.DisplayOrder = 999
    screenGui.Parent = playerGui
    
    -- Frame principal
    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainWindow"
    mainFrame.Size = UDim2.new(0, 500, 0, 350)
    mainFrame.Position = UDim2.new(0.5, -250, 0.5, -175)
    mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
    mainFrame.BorderSizePixel = 0
    mainFrame.ZIndex = 999
    
    -- Cantos arredondados
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 10)
    corner.Parent = mainFrame
    
    -- Borda neon
    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(0, 247, 255)
    stroke.Thickness = 2
    stroke.Parent = mainFrame
    
    -- Barra de t√≠tulo (√ÅREA DE DRAG)
    local titleBar = Instance.new("Frame")
    titleBar.Name = "TitleBar"
    titleBar.Size = UDim2.new(1, 0, 0, 40)
    titleBar.BackgroundColor3 = Color3.fromRGB(0, 150, 150)  -- COR FORTE para ver
    titleBar.ZIndex = 1000
    titleBar.Parent = mainFrame
    
    -- T√≠tulo com instru√ß√£o
    local titleText = Instance.new("TextLabel")
    titleText.Name = "Title"
    titleText.Size = UDim2.new(1, -80, 1, 0)
    titleText.Position = UDim2.new(0, 10, 0, 0)
    titleText.BackgroundTransparency = 1
    titleText.Text = "üñ±Ô∏è ARRASTE AQUI! üñêÔ∏è"
    titleText.TextColor3 = Color3.new(1, 1, 1)
    titleText.Font = Enum.Font.GothamBold
    titleText.TextSize = 16
    titleText.TextXAlignment = Enum.TextXAlignment.Left
    titleText.ZIndex = 1001
    titleText.Parent = titleBar
    
    -- Bot√£o fechar
    local closeBtn = Instance.new("TextButton")
    closeBtn.Name = "Close"
    closeBtn.Size = UDim2.new(0, 35, 0, 35)
    closeBtn.Position = UDim2.new(1, -40, 0.5, -17.5)
    closeBtn.BackgroundColor3 = Color3.fromRGB(255, 60, 60)
    closeBtn.Text = "‚úï"
    closeBtn.TextColor3 = Color3.new(1, 1, 1)
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.TextSize = 18
    closeBtn.AutoButtonColor = false
    closeBtn.ZIndex = 1001
    closeBtn.Parent = titleBar
    
    local closeCorner = Instance.new("UICorner")
    closeCorner.CornerRadius = UDim.new(0, 6)
    closeCorner.Parent = closeBtn
    
    -- √Årea de conte√∫do
    local contentArea = Instance.new("Frame")
    contentArea.Name = "Content"
    contentArea.Size = UDim2.new(1, -20, 1, -60)
    contentArea.Position = UDim2.new(0, 10, 0, 50)
    contentArea.BackgroundTransparency = 1
    contentArea.Parent = mainFrame
    
    -- Criar draggable window (FUNCIONAL)
    CreateDraggableWindow(mainFrame, titleBar)
    
    -- Efeitos bot√£o fechar
    closeBtn.MouseEnter:Connect(function()
        TweenService:Create(closeBtn, TweenInfo.new(0.2), {
            BackgroundColor3 = Color3.fromRGB(255, 100, 100),
            Size = UDim2.new(0, 38, 0, 38)
        }):Play()
    end)
    
    closeBtn.MouseLeave:Connect(function()
        TweenService:Create(closeBtn, TweenInfo.new(0.2), {
            BackgroundColor3 = Color3.fromRGB(255, 60, 60),
            Size = UDim2.new(0, 35, 0, 35)
        }):Play()
    end)
    
    closeBtn.MouseButton1Click:Connect(function()
        screenGui:Destroy()
    end)
    
    -- Sistema de tabs SIMPLES
    local tabButtons = Instance.new("Frame")
    tabButtons.Name = "TabButtons"
    tabButtons.Size = UDim2.new(1, 0, 0, 35)
    tabButtons.BackgroundTransparency = 1
    tabButtons.Parent = contentArea
    
    local tabContent = Instance.new("Frame")
    tabContent.Name = "TabContent"
    tabContent.Size = UDim2.new(1, 0, 1, -40)
    tabContent.Position = UDim2.new(0, 0, 0, 40)
    tabContent.BackgroundTransparency = 1
    tabContent.Parent = contentArea
    
    -- Objeto da janela
    local window = {
        Tabs = {},
        CurrentTab = 1,
        _screenGui = screenGui,
        _mainFrame = mainFrame
    }
    
    -- M√©todo para criar tab
    function window:CreateTab(tabName)
        local tabId = #self.Tabs + 1
        
        -- Bot√£o da tab
        local tabButton = Instance.new("TextButton")
        tabButton.Name = "Tab_" .. tabId
        tabButton.Size = UDim2.new(0, 100, 1, 0)
        tabButton.Position = UDim2.new(0, (tabId-1)*105, 0, 0)
        tabButton.BackgroundColor3 = tabId == 1 and Color3.fromRGB(0, 247, 255) or Color3.fromRGB(60, 60, 80)
        tabButton.Text = tabName or "Tab " .. tabId
        tabButton.TextColor3 = tabId == 1 and Color3.new(0, 0, 0) or Color3.new(1, 1, 1)
        tabButton.Font = Enum.Font.Gotham
        tabButton.TextSize = 14
        tabButton.AutoButtonColor = false
        tabButton.Parent = tabButtons
        
        local tabCorner = Instance.new("UICorner")
        tabCorner.CornerRadius = UDim.new(0, 6)
        tabCorner.Parent = tabButton
        
        -- Conte√∫do da tab
        local tabFrame = Instance.new("ScrollingFrame")
        tabFrame.Name = "TabFrame_" .. tabId
        tabFrame.Size = UDim2.new(1, 0, 1, 0)
        tabFrame.BackgroundTransparency = 1
        tabFrame.ScrollBarThickness = 4
        tabFrame.ScrollBarImageColor3 = Color3.fromRGB(0, 247, 255)
        tabFrame.ScrollingDirection = Enum.ScrollingDirection.Y
        tabFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
        tabFrame.Visible = tabId == 1
        tabFrame.Parent = tabContent
        
        local tabLayout = Instance.new("UIListLayout")
        tabLayout.Padding = UDim.new(0, 8)
        tabLayout.SortOrder = Enum.SortOrder.LayoutOrder
        tabLayout.Parent = tabFrame
        
        local tabPadding = Instance.new("UIPadding")
        tabPadding.PaddingTop = UDim.new(0, 10)
        tabPadding.PaddingLeft = UDim.new(0, 10)
        tabPadding.PaddingRight = UDim.new(0, 10)
        tabPadding.Parent = tabFrame
        
        -- Selecionar tab
        local function SelectTab()
            for i, tab in pairs(self.Tabs) do
                if tab.Frame then
                    tab.Frame.Visible = (i == tabId)
                end
                if tab.Button then
                    tab.Button.BackgroundColor3 = (i == tabId) and Color3.fromRGB(0, 247, 255) or Color3.fromRGB(60, 60, 80)
                    tab.Button.TextColor3 = (i == tabId) and Color3.new(0, 0, 0) or Color3.new(1, 1, 1)
                end
            end
            self.CurrentTab = tabId
        end
        
        -- Evento de clique
        tabButton.MouseButton1Click:Connect(SelectTab)
        
        -- Armazenar tab
        local tab = {
            Id = tabId,
            Name = tabName,
            Button = tabButton,
            Frame = tabFrame,
            Methods = {}
        }
        
        -- M√©todo para criar bot√£o
        function tab.Methods:CreateButton(btnOptions)
            local button = Instance.new("TextButton")
            button.Size = UDim2.new(1, 0, 0, 40)
            button.BackgroundColor3 = Color3.fromRGB(50, 50, 70)
            button.Text = btnOptions.Name or "Button"
            button.TextColor3 = Color3.fromRGB(0, 247, 255)
            button.Font = Enum.Font.Gotham
            button.TextSize = 14
            button.AutoButtonColor = false
            button.LayoutOrder = #tabFrame:GetChildren()
            button.Parent = tabFrame
            
            local btnCorner = Instance.new("UICorner")
            btnCorner.CornerRadius = UDim.new(0, 8)
            btnCorner.Parent = button
            
            -- Efeitos
            button.MouseEnter:Connect(function()
                TweenService:Create(button, TweenInfo.new(0.2), {
                    BackgroundColor3 = Color3.fromRGB(70, 70, 90)
                }):Play()
            end)
            
            button.MouseLeave:Connect(function()
                TweenService:Create(button, TweenInfo.new(0.2), {
                    BackgroundColor3 = Color3.fromRGB(50, 50, 70)
                }):Play()
            end)
            
            -- Clique
            if btnOptions.Callback then
                button.MouseButton1Click:Connect(function()
                    pcall(btnOptions.Callback)
                end)
            end
            
            return button
        end
        
        table.insert(self.Tabs, tab)
        return tab.Methods
    end
    
    -- Adicionar √† tela
    mainFrame.Parent = screenGui
    
    -- DEBUG: Testar drag imediatamente
    task.spawn(function()
        task.wait(0.5)
        print("‚úÖ BoladoHub carregado!")
        print("üì± Instru√ß√µes: Clique e arraste na barra AZUL")
        print("üéØ Teste: Tente mover a janela agora!")
    end)
    
    return window
end

-- Fun√ß√£o de inicializa√ß√£o
function BoladoHub:Init()
    print("üéÆ BoladoHub v5.1 - Drag 100% Funcional")
    return self
end

return BoladoHub